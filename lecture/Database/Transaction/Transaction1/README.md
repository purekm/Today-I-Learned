Transaction1<br/>
Transaction – 프로그램의 실행단위 <br/>
Overview<br/>
1. 개념 & 모델<br/>
2. Atomicity Durability<br/>
3. Isolation<br/>

일관성 유지 조건<br/>
-
명시적 무결성 제약은 데이터베이스 스키마 내에 명확하게 정의되며, 자동으로 DBMS에 의해 enforced된다.<br/>
암시적 무결성 제약은 비즈니스 규칙 혹은 로직에 의해 정해진다.<br/>

일관성을 보장하는 것은 매우 어려움. 앱 개발자가 이러한 복잡한 제약을 enforced하는 책임을 진다.<br/>

ACID Properties<br/>
-
1. 원자성<br/>
   1. 모든 작업이 db에 제대로 반영되거나, 모두 반영되지 않아야함<br/>
2. 격리 <br/>
   1. 여러 트랜잭션이 동시에 실행되어도, 각 트랜잭션은 다른 트랜잭션이 동시에 실행되고 있는 것을 인식해서는 안됨<br/>
3. 지속성<br/>
   1. 트랜잭션이 성공적으로 완료된 후에는 영구적으로 db에 반영 되어야 함<br/>
   2. partially commit ~ commit 까지의 상황을 고려함 <br/>
4. 일관성<br/>
   1. 트랜잭션이 단독으로 실행되면 데이터베이스의 일관성 유지<br/>
   2. 트랜잭션 후 합이 변하면 안됌<br/>
<br/>

Storage Structure<br/>
-
Volatile storage - 휘발성 
Non volatile storage - 디스크 고장 같은 정보 손실을 초래할 수 있는 실패에 취약함
Stable Storage - Durability를 지키기 위한 궁극의 stroage 절대 손실되지 않음<br/>
트랜잭션이 중단되면 모든 변경사항은 취소되어야 하며 rollback되어야 한다. 이를 위해 로그를 유지하며 수행.<br/>
트랜잭션이 원자성과 지속성을 가지려면, 로그 기록이 데이터베이스에 변경 사항이 적용되기 전에 stable 저장소에 기록되어야 한다.<br/>

로그 기반 복구 기법<br/>
-
1. 트랜잭션이 변경을 수행할 때마다, 트랜잭션의 ID, 데이터 항목의 ID, 이전 값과 새로운 값을 로그에 저장<br/>
2. 로그에 기록한 후 실제로 데이터베이스에 변경 사항을 반영한다.<br/>
3. 트랜잭션 실행 중 장애가 발생한 경우, 로그에 기록된 정보를 사용하여 원자성과 내구성을 보장하기위해 재실행<br/>
   중단된 경우 원자성을 보장하기 위해 수정 취소를 한다.<br/><br/>

Transaction State<br/>
-
1. Active <br/>
   1. 초기상태로, 트랜잭션이 실행되는 동안 이 상태<br/>
2. Partially committed <br/>
   1. 최종 명령문이 실행된 상태(부분적으로 커밋된 상태)<br/>
3. Failed<br/>
   1. 정상적인 실행이 더 이상 진행될 수 없음<br/>
4. Aborted<br/>
   1. 트랜잭션이 rollback되고 트랜잭션 시작 전 상태로 복원된 후의 상태이다. 중단된 후에는 2가지 옵션이 존재한다. 내부 논리 오류가 없을 경우에는 트랜잭션 재 시작이 가능하고, 트랜잭션이 종료되는 경우가 있다.<br/>
5. Committed<br/>
   1. 트랜잭션이 성공적으로 완료된 후의 상태. 취소 불가능하지만, 유일한 방법은 보상 트랜잭션을 실행하는 것<br/>
   2. 은행에 20달러 넣고 커밋되었는데, 취소하는것 (20달러를 뺌으로써 취소하는 효과)
   3. 
Commit이나 aborted 상태로 간 거면 끝난 상태이다.<br/>

외부에 관찰 가능한 쓰기<br/>
-
1. 트랜잭션이 커밋 상태에 도달한 후에만 외부에 관찰 가능한 쓰기 허용<br/>
2. 트랜잭션이 커밋된 후에 시스템에 장애가 발생해도 외부에 관찰 가능한 쓰기는 훼손되지 않는다. <br/>
3. ATM이 현금을 출금할 때, 시스템 충돌이 발생할 수 있다<br/>
   1. 재 시작 후 현금 출금이 필요하지 않을 수 있음<br/>
      1. 사용자가 자리를 떠날 수 있기 때문<br/>
      2. 그렇지 않으면, 보상 트랜잭션이 실행되어 원 상태로 되돌린다.<br/>
4. 웹 예약 과정 중 실패<br/>
   1. 사이트를 다시 방문시 예약 트랜잭션이 성공했는지 여부 출력<br/><br/>

Transaction Isolation<br/>
-
여러 트랜잭션이 동시에 실행되면서 데이터 일관성에 문제 발생 가능 <br/>
하지만 동시에 실행하는 건 여러 장점이 있음 <br/>

동시 실행의 장점<br/>
-
프로세서와 디스크 사용률 증가로 인해 트랜잭션 처리량이 향상된다.<br/>
짧은 트랜잭션이 긴 트랜잭션을 대기할 필요가 없으므로, 평균 응답 시간이 감소한다.<br/>
동시성 제어 기법- 트랜잭션 간의 충돌을 방지하고, 일관성과 격리성을 보장하기 위함<br/>
동시에 실행되는 트랜잭션간의 상호작용을 제어하여 일관성을 해치지 않게 함<br/>
